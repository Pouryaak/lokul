---
phase: 02.1-ai-sdk-ui-migration-with-routing
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/sidebar.tsx
  - src/components/chat-layout/AppSidebar.tsx
  - src/components/chat-layout/ChatLayout.tsx
autonomous: true
requirements:
  - CHAT-08
must_haves:
  truths:
    - "Collapsible sidebar exists with conversation list"
    - "Sidebar uses @blocks/sidebar-02 pattern from shadcn"
    - "New chat button creates new conversation"
    - "Sidebar integrates with existing conversation storage"
  artifacts:
    - path: "src/components/ui/sidebar.tsx"
      provides: "Base sidebar primitives from shadcn"
      exports: ["Sidebar", "SidebarProvider", "SidebarTrigger"]
    - path: "src/components/chat-layout/AppSidebar.tsx"
      provides: "App-specific sidebar with conversation list"
      exports: ["AppSidebar"]
    - path: "src/components/chat-layout/ChatLayout.tsx"
      provides: "Layout wrapper with sidebar and main content"
      exports: ["ChatLayout"]
  key_links:
    - from: "AppSidebar"
      to: "useConversations hook"
      via: "conversation list rendering"
      pattern: "useConversations()"
    - from: "ChatLayout"
      to: "AppSidebar"
      via: "component composition"
      pattern: "<AppSidebar />"
---

<objective>
Create the chat layout infrastructure with a collapsible sidebar using shadcn's sidebar primitives and the @blocks/sidebar-02 pattern.

Purpose: The chat layout provides the structural foundation for the routed chat interface. It must be in place before routing can be implemented.
Output: Reusable ChatLayout component with collapsible AppSidebar that integrates with existing conversation storage.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-ai-sdk-ui-migration-with-routing/02.1-RESEARCH.md

@/Users/poak/Documents/personal-project/Lokul/src/components/Sidebar/ConversationSidebar.tsx
@/Users/poak/Documents/personal-project/Lokul/src/hooks/useConversations.ts
@/Users/poak/Documents/personal-project/Lokul/src/lib/storage/conversations.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn sidebar component</name>
  <files>src/components/ui/sidebar.tsx</files>
  <action>
    Install the shadcn sidebar component which provides the base primitives:
    ```bash
    npx shadcn@latest add sidebar
    ```

    This creates src/components/ui/sidebar.tsx with:
    - SidebarProvider (context for state)
    - Sidebar (the collapsible panel)
    - SidebarTrigger (button to toggle)
    - SidebarContent, SidebarHeader, SidebarFooter, etc.

    The sidebar component uses CSS variables for theming that we can override with Lokul colors.
  </action>
  <verify>ls src/components/ui/sidebar.tsx</verify>
  <done>shadcn sidebar component installed with all primitives</done>
</task>

<task type="auto">
  <name>Task 2: Create AppSidebar component</name>
  <files>src/components/chat-layout/AppSidebar.tsx</files>
  <action>
    Create AppSidebar component that wraps the shadcn sidebar with app-specific content.

    Structure based on @blocks/sidebar-02 pattern:
    1. SidebarHeader with logo and new chat button
    2. SidebarContent with conversation list
    3. SidebarFooter with user/settings area

    Features:
    - "New Chat" button that navigates to /chat (creates new conversation)
    - Conversation list from useConversations hook
    - Each conversation item shows title and timestamp
    - Active conversation highlighted
    - Delete conversation option

    Use existing patterns from ConversationSidebar.tsx but adapt for shadcn sidebar structure:
    - Use useConversations() for conversation list
    - Use useNavigate() for navigation (will be used in next plan)
    - For now, accept onNewChat prop for new chat action

    Styling with Lokul theme:
    - Background: white or subtle cream
    - Active item: orange accent (#FF6B35)
    - Hover: light orange background
    - Border: subtle gray

    The component should be self-contained and not depend on routing being set up yet.
  </action>
  <verify>npm run type-check passes</verify>
  <done>AppSidebar component exists with header, conversation list, and footer</done>
</task>

<task type="auto">
  <name>Task 3: Create ChatLayout component</name>
  <files>src/components/chat-layout/ChatLayout.tsx</files>
  <action>
    Create ChatLayout component that composes AppSidebar with main content area.

    Structure:
    ```tsx
    <SidebarProvider>
      <AppSidebar />
      <main className="flex-1 overflow-hidden">
        <SidebarTrigger /> {/* Shows when sidebar collapsed */}
        {children} {/* Chat content goes here */}
      </main>
    </SidebarProvider>
    ```

    The layout should:
    1. Wrap everything in SidebarProvider for state management
    2. Include AppSidebar on the left
    3. Have a main content area that takes remaining space
    4. Include SidebarTrigger for mobile/toggle
    5. Use full viewport height (h-screen)
    6. Apply Lokul background color (#FFF8F0) to main area

    This component will be used as the layout for /chat routes.
    It should accept children prop for the chat interface.

    Export ChatLayout as the default export.
  </action>
  <verify>npm run type-check passes</verify>
  <done>ChatLayout component composes sidebar and main content area</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. TypeScript compilation passes
2. Components can be imported without errors
3. Sidebar primitives from shadcn are properly themed
4. AppSidebar integrates with useConversations hook
</verification>

<success_criteria>
- shadcn sidebar component installed
- AppSidebar component with conversation list
- ChatLayout component with sidebar + main content
- All components type-safe
- Lokul theme colors applied
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-ai-sdk-ui-migration-with-routing/02.1-02-SUMMARY.md`
</output>
