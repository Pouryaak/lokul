---
phase: 02.1-ai-sdk-ui-migration-with-routing
plan: 04
type: execute
wave: 3
depends_on: ["02.1-01", "02.1-03"]
files_modified:
  - src/components/ai-elements/
  - src/components/chat/AIChatInterface.tsx
autonomous: true
requirements:
  - CHAT-01
  - CHAT-02
  - CHAT-03
  - CHAT-04
  - CHAT-05
must_haves:
  truths:
    - "ai-elements components installed and customized with Lokul theme"
    - "Auto-resizing input field works with Enter and Send button"
    - "AI responses stream token-by-token without lag"
    - "Messages render with Markdown formatting"
    - "Code blocks have syntax highlighting"
  artifacts:
    - path: "src/components/ai-elements/conversation.tsx"
      provides: "ai-elements Conversation component"
      exports: ["Conversation", "ConversationContent", "ConversationEmptyState"]
    - path: "src/components/ai-elements/message.tsx"
      provides: "ai-elements Message component"
      exports: ["Message", "MessageContent", "MessageResponse"]
    - path: "src/components/ai-elements/prompt-input.tsx"
      provides: "ai-elements PromptInput component"
      exports: ["PromptInput", "PromptInputTextarea", "PromptInputSubmit"]
    - path: "src/components/chat/AIChatInterface.tsx"
      provides: "Main chat interface using ai-elements"
      exports: ["AIChatInterface"]
  key_links:
    - from: "AIChatInterface"
      to: "useAIChat hook"
      via: "hook call"
      pattern: "const { messages, sendMessage } = useAIChat()"
    - from: "PromptInput"
      to: "sendMessage"
      via: "onSubmit handler"
      pattern: "onSubmit={(msg) => sendMessage({ text: msg.text })}"
---

<objective>
Install ai-elements components and create the main chat interface using AI SDK UI patterns with ai-elements components.

Purpose: This is the core chat UI that users interact with. It replaces the custom components with standardized ai-elements that handle complex UX patterns.
Output: AIChatInterface component using ai-elements with Lokul theme customization.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-ai-sdk-ui-migration-with-routing/02.1-RESEARCH.md

@/Users/poak/Documents/personal-project/Lokul/src/components/Chat/ChatInterface.tsx
@/Users/poak/Documents/personal-project/Lokul/src/components/Chat/MessageInput.tsx
@/Users/poak/Documents/personal-project/Lokul/src/components/Chat/MessageBubble.tsx
@/Users/poak/Documents/personal-project/Lokul/src/hooks/useAIChat.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install ai-elements components</name>
  <files>src/components/ai-elements/</files>
  <action>
    Install ai-elements components via the shadcn CLI:

    ```bash
    npx shadcn@latest add https://ai-sdk.dev/elements/api/registry/all.json
    ```

    Or install individual components:
    ```bash
    npx ai-elements@latest add conversation
    npx ai-elements@latest add message
    npx ai-elements@latest add prompt-input
    npx ai-elements@latest add loader
    npx ai-elements@latest add code-block
    ```

    This should create files in src/components/ai-elements/:
    - conversation.tsx
    - message.tsx
    - prompt-input.tsx
    - loader.tsx
    - code-block.tsx

    Verify the components are installed and TypeScript types are available.
  </action>
  <verify>ls src/components/ai-elements/</verify>
  <done>ai-elements components installed in src/components/ai-elements/</done>
</task>

<task type="auto">
  <name>Task 2: Customize ai-elements with Lokul theme</name>
  <files>src/components/ai-elements/message.tsx, src/components/ai-elements/prompt-input.tsx</files>
  <action>
    Override ai-elements components with Lokul styling.

    Create wrapper components or modify the installed components to use Lokul colors:

    1. **Message styling** - Update message.tsx or create wrappers:
       - User messages: bg-[#FF6B35], text-white, rounded-2xl
       - Assistant messages: bg-white, border border-gray-200, rounded-2xl
       - Max-width: user 85%, assistant 90%

    2. **PromptInput styling** - Update prompt-input.tsx:
       - Input background: white
       - Border: subtle gray
       - Focus ring: orange (#FF6B35)
       - Submit button: orange gradient with shine effect
       - Placeholder: "Message Lokul..."

    3. **Conversation styling** - Update conversation.tsx:
       - Background: #FFF8F0 (Lokul cream)
       - Scroll behavior: smooth auto-scroll

    Use cn() utility for conditional classes. Reference existing components:
    - MessageBubble.tsx for user/assistant styling
    - MessageInput.tsx for input styling
    - ChatInterface.tsx for layout

    The goal is to maintain ai-elements functionality while applying Lokul's visual design.
  </action>
  <verify>npm run type-check passes</verify>
  <done>ai-elements components styled with Lokul orange/cream theme</done>
</task>

<task type="auto">
  <name>Task 3: Create AIChatInterface component</name>
  <files>src/components/chat/AIChatInterface.tsx</files>
  <action>
    Create AIChatInterface component that composes ai-elements with useAIChat hook.

    Structure:
    ```tsx
    function AIChatInterface({ conversationId, modelId }: Props) {
      const { messages, sendMessage, status, error } = useAIChat({
        conversationId,
        modelId,
      });

      return (
        <div className="flex h-full flex-col bg-[#FFF8F0]">
          <Conversation className="flex-1">
            <ConversationContent>
              {messages.length === 0 ? (
                <ConversationEmptyState
                  icon={<MessageSquare className="size-12 text-[#FF6B35]" />}
                  title="Start a conversation"
                  description="Type a message below to begin chatting with Lokul"
                />
              ) : (
                messages.map((message) => (
                  <Message key={message.id} from={message.role}>
                    <MessageContent>
                      {message.parts
                        .filter((p): p is TextPart => p.type === 'text')
                        .map((part, i) => (
                          <MessageResponse key={i}>{part.text}</MessageResponse>
                        ))}
                    </MessageContent>
                  </Message>
                ))
              )}
              {status === 'streaming' && <Loader />}
            </ConversationContent>
            <ConversationScrollButton />
          </Conversation>

          <PromptInput
            onSubmit={(msg) => sendMessage({ text: msg.text })}
            disabled={status === 'streaming'}
          >
            <PromptInputTextarea placeholder="Message Lokul..." />
            <PromptInputSubmit
              status={status === 'streaming' ? 'streaming' : 'ready'}
            />
          </PromptInput>
        </div>
      );
    }
    ```

    Features to implement:
    1. Use Conversation component for scrollable message area
    2. Map messages from useAIChat to Message components
    3. Show Loader when status is 'streaming'
    4. PromptInput with auto-resizing textarea
    5. Handle send via sendMessage from useAIChat
    6. Show error banner if error exists

    Props interface:
    ```typescript
    interface AIChatInterfaceProps {
      conversationId: string;
      modelId: string;
    }
    ```

    Import ai-elements from '@/components/ai-elements/*'.
  </action>
  <verify>npm run type-check passes</verify>
  <done>AIChatInterface component created with ai-elements composition</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. TypeScript compilation passes
2. AIChatInterface can be rendered
3. ai-elements components have Lokul styling
4. useAIChat hook integrates correctly
</verification>

<success_criteria>
- ai-elements components installed
- Components styled with Lokul theme (orange/cream)
- AIChatInterface composes all elements correctly
- Streaming status shows Loader component
- Input auto-resizes and submits on Enter
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-ai-sdk-ui-migration-with-routing/02.1-04-SUMMARY.md`
</output>
